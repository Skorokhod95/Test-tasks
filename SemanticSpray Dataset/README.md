
# Semantic Spray Dataset

### Задача

Проезжающие машины в дождливое время образуют вокруг себя облако брызг,
которые препятствуют нормальной езде беспилотного автомобиля. Требуется
предложить и реализовать модель, которая будет классифицировать точки на
3 класса:

-   0: фон
-   1: машина
-   2: шум (брызги и выхлопные газы)

Для обучения и тестирования модели рекомендуется использовать датасет
[semantic_spray_dataset](https://github.innominds.com/aldipiroli/semantic_spray_dataset).



<img src="https://github.com/uulm-mrm/semantic_spray_dataset/blob/main/img/teaser_0.gif" width="1000" height="1000" />

### Шаги выполнения задачи

1.  Преобразование датасета:

Избрана меньшая выборка из 500 точек, поскольку использование 30000
точек для около 1200 примеров кажется избыточным, а также приводит к
слишком большому разнообразию количества точек в каждом облаке.

1.  Моделирование процесса:

Реализация PointNet в Keras: Начата работа с реализацией модели PointNet
с использованием библиотеки Keras.

1.  Улучшение процесса обучения:

Применение лосса из литературного источника \[1\] с использованием
энергии: Использование лосса, описанного в статье \[1\], который
включает в себя энергетическую компоненту для улучшения процесса
обучения модели.

Список литературы:

1.  [Piroli A. et al. Energy-based Detection of Adverse Weather Effects
    in LiDAR Data //IEEE Robotics and Automation Letters. --
    2023.](https://arxiv.org/pdf/2305.16129.pdf)
2.  [Point cloud segmentation with
    PointNet](https://keras.io/examples/vision/pointnet_segmentation/)

### Результаты
1. Point Net на 500 точках 10 эпох.
   ![image](https://github.com/Skorokhod95/Test-tasks/blob/main/SemanticSpray%20Dataset/files/start.png)
2. Point Net на 500 точках 10 эпох с взвешиванием классов.
   ![image](https://github.com/Skorokhod95/Test-tasks/blob/main/SemanticSpray%20Dataset/files/weighted.png)
3. Point Net на 500 точках 10 эпох с измененной loss функцией (добавлена часть с рассчетом "энергии").
   ![image](https://github.com/Skorokhod95/Test-tasks/blob/main/SemanticSpray%20Dataset/files/energy.png)

### Направления исследования

1.  Преобразование данных:

Согласно статье \[1\], перед использованием модели AWNet рекомендуется
выполнить вокселизацию данных. Этот метод можно попробовать, но следует
учитывать, что количество признаков (точек) в данных может значительно
увеличиться, что может быть вызовом для обработки больших объемов
данных. Можно экспериментировать с разными вариантами преобразования
данных, такими как увеличение или уменьшение количества точек и т. д.

1.  Использование другой модели:

Попробовать другие модели или архитектуры нейронных сетей для решения
задачи обнаружения аномалий в LiDAR данных. Это может включать в себя
использование различных сверточных или рекуррентных архитектур, которые
могут быть более подходящими для данной задачи.

1.  Настройка гиперпараметров модели:

Исследование различных комбинаций гиперпараметров модели, таких как
скорость обучения, размер пакета (batch size), количество эпох обучения
и других параметров, чтобы достичь лучших результатов на валидационной
выборке. Эти шаги могут помочь улучшить результаты вашей модели и
дополнительно исследовать возможности оптимизации процесса обучения.

### Как пользоваться репозиторием

Related_code.ipynb - содержит всю проделанную работу.

PointNet.py - файл с применяемой моделью PointNet.

best.weights.h5 - веса для модели PointNet с получившимся результатом.

testing.py - файл разметки поданых данных формата .bin. Необходимо иметь
папку test с файлами .bin, которые необходимо разметить. Внутри папки
test в папку labels запишутся результаты для каждого облака в формате
.labels.

